<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Atmosphere Functions · RetrievalToolbox.jl</title><meta name="title" content="Atmosphere Functions · RetrievalToolbox.jl"/><meta property="og:title" content="Atmosphere Functions · RetrievalToolbox.jl"/><meta property="twitter:title" content="Atmosphere Functions · RetrievalToolbox.jl"/><meta name="description" content="Documentation for RetrievalToolbox.jl."/><meta property="og:description" content="Documentation for RetrievalToolbox.jl."/><meta property="twitter:description" content="Documentation for RetrievalToolbox.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">RetrievalToolbox.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Main</a></li><li><a class="tocitem" href="../../design/design/">Design</a></li><li><span class="tocitem">Concepts</span><ul><li><a class="tocitem" href="../../concepts/core_concepts/">Core Concepts</a></li><li><a class="tocitem" href="../../concepts/radiance/">Radiance</a></li><li><a class="tocitem" href="../../concepts/phasefunction/">Scattering Phasefunction</a></li></ul></li><li><span class="tocitem">Functions</span><ul><li><a class="tocitem" href="../state_vector_functions/">State Vector Functions</a></li><li class="is-active"><a class="tocitem" href>Atmosphere Functions</a></li></ul></li><li><span class="tocitem">Types</span><ul><li><a class="tocitem" href="../../types/atmosphere_types/">Atmosphere Types</a></li><li><a class="tocitem" href="../../types/buffer_types/">Buffer Types</a></li><li><a class="tocitem" href="../../types/state_vector_types/">State Vector Types</a></li></ul></li><li><span class="tocitem">Working with Julia</span><ul><li><a class="tocitem" href="../../julia/develop/">Develop</a></li><li><a class="tocitem" href="../../julia/dicts/">Dictionaries</a></li><li><a class="tocitem" href="../../julia/units/">Units</a></li></ul></li><li><span class="tocitem">Pitfalls</span><ul><li><a class="tocitem" href="../../pitfalls/pitfalls/">Pitfalls</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Functions</a></li><li class="is-active"><a href>Atmosphere Functions</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Atmosphere Functions</a></li></ul></nav><div class="docs-right"><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Atmosphere-functions"><a class="docs-heading-anchor" href="#Atmosphere-functions">Atmosphere functions</a><a id="Atmosphere-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Atmosphere-functions" title="Permalink"></a></h1><p>Functions below are designed to operate on atmosphere object, and for the time being mostly on <code>EarthAtmosphere</code> ones.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RetrievalToolbox.JPL_gravity-Tuple{Number, Number}" href="#RetrievalToolbox.JPL_gravity-Tuple{Number, Number}"><code>RetrievalToolbox.JPL_gravity</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">JPL_gravity(
    latitude::Number,
    altitude::Number;
    earth_equatorial_radius
) -&gt; Any
</code></pre><p>Calculates local gravity given some latitude and altitude. Note that the altitude can be be a simple number, in which the input is assumed to be in meters. If you supply a <code>Unitful</code> quantity, appropriate unit conversions are done. In either case, this function will return a <code>Unitful</code> quantity that will reduce to acceleration [m s⁻²].</p><p><strong>Details</strong></p><p>This code was taken from MS3 / the CSU simulator suite, with heritage related to the OCO-1 retrieval algorithm written at JPL. See https://github.com/nasa/RtRetrievalFramework at <code>./lib/implementation/altitude_hydrostatic.cc</code>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RetrievalToolbox.atmosphere_element_statevector_rollback!-Tuple{AbstractAtmosphereElement, AbstractStateVectorElement}" href="#RetrievalToolbox.atmosphere_element_statevector_rollback!-Tuple{AbstractAtmosphereElement, AbstractStateVectorElement}"><code>RetrievalToolbox.atmosphere_element_statevector_rollback!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">atmosphere_element_statevector_rollback!(
    atm_element::AbstractAtmosphereElement,
    sve::AbstractStateVectorElement
) -&gt; Any
</code></pre><p>Default behavior: do nothing</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RetrievalToolbox.atmosphere_element_statevector_rollback!-Tuple{GasAbsorber, GasLevelScalingFactorSVE}" href="#RetrievalToolbox.atmosphere_element_statevector_rollback!-Tuple{GasAbsorber, GasLevelScalingFactorSVE}"><code>RetrievalToolbox.atmosphere_element_statevector_rollback!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">atmosphere_element_statevector_rollback!(
    atm_element::GasAbsorber,
    sve::GasLevelScalingFactorSVE
) -&gt; Any
</code></pre><p>Rolls back the <code>GasAbsorber</code> volume mixing ratio profile to its first-guess state as defined in <code>sve</code>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RetrievalToolbox.atmosphere_element_statevector_update!-Tuple{AbstractAtmosphereElement, AbstractStateVectorElement}" href="#RetrievalToolbox.atmosphere_element_statevector_update!-Tuple{AbstractAtmosphereElement, AbstractStateVectorElement}"><code>RetrievalToolbox.atmosphere_element_statevector_update!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">atmosphere_element_statevector_update!(
    atm_element::AbstractAtmosphereElement,
    sve::AbstractStateVectorElement
) -&gt; Any
</code></pre><p>Default function to update the atmosphere element <code>atm_element</code> according to the current value of the state vector element <code>sve</code>. This does nothing!</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RetrievalToolbox.atmosphere_element_statevector_update!-Tuple{GasAbsorber, GasLevelScalingFactorSVE}" href="#RetrievalToolbox.atmosphere_element_statevector_update!-Tuple{GasAbsorber, GasLevelScalingFactorSVE}"><code>RetrievalToolbox.atmosphere_element_statevector_update!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">atmosphere_element_statevector_update!(
    atm_element::GasAbsorber,
    sve::GasLevelScalingFactorSVE
) -&gt; Any
</code></pre><p>Updates the <code>GasAbsorber</code> volume mixing ratio profile according to <code>sve</code>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RetrievalToolbox.atmosphere_element_statevector_update!-Tuple{GasAbsorber, GasVMRProfileSVE}" href="#RetrievalToolbox.atmosphere_element_statevector_update!-Tuple{GasAbsorber, GasVMRProfileSVE}"><code>RetrievalToolbox.atmosphere_element_statevector_update!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">atmosphere_element_statevector_update!(
    atm_element::GasAbsorber,
    sve::GasVMRProfileSVE
) -&gt; Any
</code></pre><p>Updates atmospheric element <code>atm_element</code> if a <code>GasVMRProfileSVE</code> is present.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RetrievalToolbox.atmosphere_element_statevector_update!-Union{Tuple{T}, Tuple{Vector{T}, AbstractStateVector}} where T&lt;:AbstractAtmosphereElement" href="#RetrievalToolbox.atmosphere_element_statevector_update!-Union{Tuple{T}, Tuple{Vector{T}, AbstractStateVector}} where T&lt;:AbstractAtmosphereElement"><code>RetrievalToolbox.atmosphere_element_statevector_update!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">atmosphere_element_statevector_update!(
    atm_elements::Array{T&lt;:AbstractAtmosphereElement, 1},
    SV::AbstractStateVector
)
</code></pre><p>Function to update all atmosphere elements in the vector <code>atm_elements</code> according to the current value of all state vector elements in the state vector <code>SV</code>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RetrievalToolbox.atmosphere_statevector_update!-Tuple{AbstractAtmosphere, TemperatureOffsetSVE}" href="#RetrievalToolbox.atmosphere_statevector_update!-Tuple{AbstractAtmosphere, TemperatureOffsetSVE}"><code>RetrievalToolbox.atmosphere_statevector_update!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Updates the atmosphere `atm` for a `TemperatureOffsetSVE` state vector element.</code></pre></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RetrievalToolbox.calculate_altitude_and_gravity!-Tuple{EarthScene}" href="#RetrievalToolbox.calculate_altitude_and_gravity!-Tuple{EarthScene}"><code>RetrievalToolbox.calculate_altitude_and_gravity!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calculate_altitude_and_gravity!(scene::EarthScene)
</code></pre><p>Calculates altitude and gravity for an <code>EarthScene</code>, assuming that all other needed quantities have been inserted accordingly, namely: pressure levels, temperatures layers, specific humidity layers and location. Note! Layer-based values are calculated in this function call and overwrite existing values!</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RetrievalToolbox.calculate_altitude_and_gravity_levels!-Tuple{AbstractVector, AbstractVector, AbstractVector, AbstractVector, AbstractVector, Number, EarthLocation}" href="#RetrievalToolbox.calculate_altitude_and_gravity_levels!-Tuple{AbstractVector, AbstractVector, AbstractVector, AbstractVector, AbstractVector, Number, EarthLocation}"><code>RetrievalToolbox.calculate_altitude_and_gravity_levels!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calculate_altitude_and_gravity_levels!(
    z_levels::AbstractVector,
    g_levels::AbstractVector,
    p_levels::AbstractVector,
    T_layers::AbstractVector,
    SH_layers::AbstractVector,
    p_surf::Number,
    location::EarthLocation
)
</code></pre><p>Calculates altitude and gravity levels for Earth-type atmospheres, in-place. For now, this function over-writes <code>altitude_levels</code> and <code>gravity_levels</code> in units of <code>m</code> and <code>m/s^2</code> respectively!</p><p><strong>Details</strong></p><p>Given some atmospheric inputs (p, T, q) and the scene latitude and altitude, this function calculates the altitude and gravity profiles (on levels) corresponding to the pressure levels. These outputs should then be used to construct atmosphere objects (EarthAtmosphere).</p><p>At this point, <code>p_levels</code> must be in [Pa], <code>T_layers</code> in [K], <code>SH_layers</code> in [1], and the <code>location.altitude</code> in [m]. Alternatively, Unitful arrays with units can be used.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RetrievalToolbox.calculate_gravity_from_z!-Tuple{EarthAtmosphere}" href="#RetrievalToolbox.calculate_gravity_from_z!-Tuple{EarthAtmosphere}"><code>RetrievalToolbox.calculate_gravity_from_z!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calculate_gravity_from_z!(atm::EarthAtmosphere; g)
</code></pre><p>Calculates local gravity based on altitude levels. The optional argument <code>g</code> can be supplied if users want a latitude=dependent surface-level gravity. Otherwise the standard gravity g0 (9.80655 ms⁻²) is used. Note that <code>g</code> must be in compatible units of acceleration.</p><p><strong>Details</strong></p><p>The gravity <span>$g&#39;(z)$</span> at altitude <span>$z$</span> is calculated as</p><p><span>$g&#39;(z) = g \cdot (\frac{R_e}{R_e + z})^2$</span></p><p>where <span>$R_e$</span> is the (mean) Earth radius and <span>$g$</span> is the assumed gravity at the surface.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RetrievalToolbox.calculate_layers!-Tuple{EarthAtmosphere}" href="#RetrievalToolbox.calculate_layers!-Tuple{EarthAtmosphere}"><code>RetrievalToolbox.calculate_layers!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calculate_layers!(atm::EarthAtmosphere)
</code></pre><p>In-place calculation of mid-layer values for all relevant profiles in an <code>EarthAtmosphere</code> object (p, p MET, q, T, z, g).</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RetrievalToolbox.calculate_xgas-Tuple{AbstractAtmosphere}" href="#RetrievalToolbox.calculate_xgas-Tuple{AbstractAtmosphere}"><code>RetrievalToolbox.calculate_xgas</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calculate_xgas(atm::AbstractAtmosphere; gas_name) -&gt; Dict
</code></pre><p>Calculates the XGAS from an <code>AbstractAtmosphere</code> <strong>atm</strong>.</p><p>The column-averaged dry-air mole fraction is calculated according to O&#39;Dell et al., 10.5194/amt-5-99-2012. Note that the returned quantity comes with the same unit as defined in the <code>GasAbsorber</code> object, which defines the VMR levels of that particular gas.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RetrievalToolbox.create_ACOS_pressure_grid-Tuple{Union{Unitful.Quantity{T, 𝐌 𝐋^-1 𝐓^-2, U}, Unitful.Level{L, S, Unitful.Quantity{T, 𝐌 𝐋^-1 𝐓^-2, U}} where {L, S}} where {T, U}}" href="#RetrievalToolbox.create_ACOS_pressure_grid-Tuple{Union{Unitful.Quantity{T, 𝐌 𝐋^-1 𝐓^-2, U}, Unitful.Level{L, S, Unitful.Quantity{T, 𝐌 𝐋^-1 𝐓^-2, U}} where {L, S}} where {T, U}}"><code>RetrievalToolbox.create_ACOS_pressure_grid</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">create_ACOS_pressure_grid(
    psurf::Union{Unitful.Quantity{T, 𝐌 𝐋^-1 𝐓^-2, U}, Unitful.Level{L, S, Unitful.Quantity{T, 𝐌 𝐋^-1 𝐓^-2, U}} where {L, S}} where {T, U}
) -&gt; Vector
</code></pre><p>Creates the ACOS-type pressure grid on 20 levels</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RetrievalToolbox.create_UoL_pressure_grid-Tuple{Union{Unitful.Quantity{T, 𝐌 𝐋^-1 𝐓^-2, U}, Unitful.Level{L, S, Unitful.Quantity{T, 𝐌 𝐋^-1 𝐓^-2, U}} where {L, S}} where {T, U}, Union{Unitful.Quantity{T, 𝐌 𝐋^-1 𝐓^-2, U}, Unitful.Level{L, S, Unitful.Quantity{T, 𝐌 𝐋^-1 𝐓^-2, U}} where {L, S}} where {T, U}}" href="#RetrievalToolbox.create_UoL_pressure_grid-Tuple{Union{Unitful.Quantity{T, 𝐌 𝐋^-1 𝐓^-2, U}, Unitful.Level{L, S, Unitful.Quantity{T, 𝐌 𝐋^-1 𝐓^-2, U}} where {L, S}} where {T, U}, Union{Unitful.Quantity{T, 𝐌 𝐋^-1 𝐓^-2, U}, Unitful.Level{L, S, Unitful.Quantity{T, 𝐌 𝐋^-1 𝐓^-2, U}} where {L, S}} where {T, U}}"><code>RetrievalToolbox.create_UoL_pressure_grid</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">create_UoL_pressure_grid(
    p_surf::Union{Unitful.Quantity{T, 𝐌 𝐋^-1 𝐓^-2, U}, Unitful.Level{L, S, Unitful.Quantity{T, 𝐌 𝐋^-1 𝐓^-2, U}} where {L, S}} where {T, U},
    p_tropo::Union{Unitful.Quantity{T, 𝐌 𝐋^-1 𝐓^-2, U}, Unitful.Level{L, S, Unitful.Quantity{T, 𝐌 𝐋^-1 𝐓^-2, U}} where {L, S}} where {T, U};
    N_total
) -&gt; Vector
</code></pre><p>Creates the &#39;classic&#39; University of Leicester-type pressure grid</p><p><strong>Details</strong></p><p>A pressure grid is generated with fixed 5 stratospheric levels. The sixth level is halfway between tropopause pressure and level 5, and the seventh level is the tropopause pressure itself. Finally, the remaining levels are evenly spaced between the tropopause and the surface pressure. The total number of pressure levels must be greater than 8 (default: 20). If the tropopause pressure is larger than 8000 Pa (i.e. higher in the atmosphere), levels 6 and 7 are then set to predefined values and the tropopause is then considered to be level 7.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RetrievalToolbox.create_empty_EarthAtmosphere-Tuple{Integer, Integer, Type{&lt;:Real}}" href="#RetrievalToolbox.create_empty_EarthAtmosphere-Tuple{Integer, Integer, Type{&lt;:Real}}"><code>RetrievalToolbox.create_empty_EarthAtmosphere</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">create_empty_EarthAtmosphere(
    Nlev::Integer,
    Nlev_met::Integer,
    T::Type{&lt;:Real};
    pressure_unit,
    met_pressure_unit,
    temperature_unit,
    specific_humidity_unit,
    altitude_unit,
    gravity_unit,
    U,
    U
) -&gt; EarthAtmosphere
</code></pre><p>Creates an empty <code>EarthAtmosphere</code> object with the specified number of retrieval grid levels, meteorological grid levels, array type <code>T</code> as well as units for the profiles. This function takes optional arguments to define the units for the various profiles.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RetrievalToolbox.create_example_atmosphere-Tuple{String, Integer}" href="#RetrievalToolbox.create_example_atmosphere-Tuple{String, Integer}"><code>RetrievalToolbox.create_example_atmosphere</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">create_example_atmosphere(
    name::String,
    Nlev::Integer;
    T,
    surface_pressure,
    altitude,
    is_example
) -&gt; EarthAtmosphere{Float64}
</code></pre><p>Creates an <code>EarthAtmosphere</code> object based on some representative atmospheres that were extracted from NASA GMAO&#39;s MERRA2 reanalysis and Sourish Basu&#39;s CO2/CH4. Must provide the name of the example atmosphere <code>name</code> as well as the intended number of pressure levels for the retrieval grid, <code>Nlev</code>, to be filled out be the user later.</p><p>Optional arguments are <code>surface_pressure</code> or <code>altitude</code> (must choose one or none, never both) to adjust the model atmosphere accordingly.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RetrievalToolbox.create_example_gas_profile-Tuple{String, String, AbstractSpectroscopy, Vector{&lt;:Union{Unitful.Quantity{T, 𝐌 𝐋^-1 𝐓^-2, U}, Unitful.Level{L, S, Unitful.Quantity{T, 𝐌 𝐋^-1 𝐓^-2, U}} where {L, S}} where {T, U}}}" href="#RetrievalToolbox.create_example_gas_profile-Tuple{String, String, AbstractSpectroscopy, Vector{&lt;:Union{Unitful.Quantity{T, 𝐌 𝐋^-1 𝐓^-2, U}, Unitful.Level{L, S, Unitful.Quantity{T, 𝐌 𝐋^-1 𝐓^-2, U}} where {L, S}} where {T, U}}}"><code>RetrievalToolbox.create_example_gas_profile</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">create_example_gas_profile(
    name::String,
    gas_name::String,
    spec::AbstractSpectroscopy,
    plevels::Vector{&lt;:Union{Unitful.Quantity{T, 𝐌 𝐋^-1 𝐓^-2, U}, Unitful.Level{L, S, Unitful.Quantity{T, 𝐌 𝐋^-1 𝐓^-2, U}} where {L, S}} where {T, U}};
    is_example
) -&gt; GasAbsorber
</code></pre><p>Creates a gas profile from an example atmosphere, and attaches it to a supplied spectroscopy object <code>spec</code>. Pressure levels must also be given, which have to match the retrieval pressure levels.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RetrievalToolbox.create_level_from_midlayer-Tuple{Any}" href="#RetrievalToolbox.create_level_from_midlayer-Tuple{Any}"><code>RetrievalToolbox.create_level_from_midlayer</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">create_level_from_midlayer(q) -&gt; Any
</code></pre><p>Creates a level-based profile from one defined on middle-of-the-layer. Assumes that the mid-layer value is well-approximated by half the value of the layer-boundary values.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RetrievalToolbox.create_pressure_weights-Tuple{AbstractAtmosphere}" href="#RetrievalToolbox.create_pressure_weights-Tuple{AbstractAtmosphere}"><code>RetrievalToolbox.create_pressure_weights</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Calculates the pressure weights according to O&#39;Dell et al. in 10.5194/amt-5-99-2012. Note that this assumes that the gas concentrations vary linearly with pressure, as implemented in the function <code>calculate_gas_optical_depth_profiles</code>.</p><pre><code class="language-julia hljs">create_pressure_weights(
    atm::AbstractAtmosphere;
    N_sub
) -&gt; Any
</code></pre></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RetrievalToolbox.get_gas_from_name-Tuple{EarthAtmosphere, String}" href="#RetrievalToolbox.get_gas_from_name-Tuple{EarthAtmosphere, String}"><code>RetrievalToolbox.get_gas_from_name</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_gas_from_name(
    atm::EarthAtmosphere,
    name::String
) -&gt; Union{Nothing, AbstractAtmosphereElement}
</code></pre><p>Given an atmosphere object, this function returns a reference to the gas object whose name is the same as some string <code>name</code>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RetrievalToolbox.list_example_atmospheres-Tuple{}" href="#RetrievalToolbox.list_example_atmospheres-Tuple{}"><code>RetrievalToolbox.list_example_atmospheres</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">list_example_atmospheres() -&gt; Vector{String}
</code></pre><p>Lists all available example atmospheres that can be loaded with <code>create_example_atmosphere</code>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RetrievalToolbox.update_specific_humidity_from_H2O!-Tuple{EarthAtmosphere}" href="#RetrievalToolbox.update_specific_humidity_from_H2O!-Tuple{EarthAtmosphere}"><code>RetrievalToolbox.update_specific_humidity_from_H2O!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_specific_humidity_from_H2O!(
    atm::EarthAtmosphere
) -&gt; Bool
</code></pre><p>Updates the specific humidity profile of the atmosphere <code>atm</code>, if an H2O profile is available as an atmospheric element. Does <em>not</em> update gravity and altitude profiles!</p></div></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../state_vector_functions/">« State Vector Functions</a><a class="docs-footer-nextpage" href="../../types/atmosphere_types/">Atmosphere Types »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Monday 29 September 2025 19:38">Monday 29 September 2025</span>. Using Julia version 1.11.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
