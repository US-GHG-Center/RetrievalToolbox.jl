<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Dictionaries · RetrievalToolbox.jl</title><meta name="title" content="Dictionaries · RetrievalToolbox.jl"/><meta property="og:title" content="Dictionaries · RetrievalToolbox.jl"/><meta property="twitter:title" content="Dictionaries · RetrievalToolbox.jl"/><meta name="description" content="Documentation for RetrievalToolbox.jl."/><meta property="og:description" content="Documentation for RetrievalToolbox.jl."/><meta property="twitter:description" content="Documentation for RetrievalToolbox.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">RetrievalToolbox.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Main</a></li><li><span class="tocitem">Concepts</span><ul><li><a class="tocitem" href="../../concepts/fundamentals/">Fundamentals</a></li><li><a class="tocitem" href="../../concepts/core_concepts/">Core Concepts</a></li><li><a class="tocitem" href="../../concepts/radiance/">Radiance</a></li><li><a class="tocitem" href="../../concepts/phasefunction/">Scattering Phasefunction</a></li></ul></li><li><a class="tocitem" href="../../design/design/">Design</a></li><li><span class="tocitem">Functions</span><ul><li><a class="tocitem" href="../../functions/state_vector_functions/">State Vector Functions</a></li><li><a class="tocitem" href="../../functions/atmosphere_functions/">Atmosphere Functions</a></li><li><a class="tocitem" href="../../functions/instrument_functions/">Instrument Functions</a></li></ul></li><li><span class="tocitem">Types</span><ul><li><a class="tocitem" href="../../types/atmosphere_types/">Atmosphere Types</a></li><li><a class="tocitem" href="../../types/buffer_types/">Buffer Types</a></li><li><a class="tocitem" href="../../types/dispersion_types/">Dispersion Types</a></li><li><a class="tocitem" href="../../types/RT_types/">Radiative Transfer Method Types</a></li><li><a class="tocitem" href="../../types/state_vector_types/">State Vector Types</a></li><li><a class="tocitem" href="../../types/surface_types/">Surface Types</a></li></ul></li><li><span class="tocitem">Working with Julia</span><ul><li><a class="tocitem" href="../develop/">Develop</a></li><li class="is-active"><a class="tocitem" href>Dictionaries</a><ul class="internal"><li><a class="tocitem" href="#Introduction"><span>Introduction</span></a></li><li><a class="tocitem" href="#Usage-in-RetrievalToolbox"><span>Usage in RetrievalToolbox</span></a></li></ul></li><li><a class="tocitem" href="../units/">Units</a></li></ul></li><li><span class="tocitem">Pitfalls</span><ul><li><a class="tocitem" href="../../pitfalls/pitfalls/">Pitfalls</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Working with Julia</a></li><li class="is-active"><a href>Dictionaries</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Dictionaries</a></li></ul></nav><div class="docs-right"><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="working_with_dicts"><a class="docs-heading-anchor" href="#working_with_dicts">Working with Dictionaries</a><a id="working_with_dicts-1"></a><a class="docs-heading-anchor-permalink" href="#working_with_dicts" title="Permalink"></a></h1><h2 id="Introduction"><a class="docs-heading-anchor" href="#Introduction">Introduction</a><a id="Introduction-1"></a><a class="docs-heading-anchor-permalink" href="#Introduction" title="Permalink"></a></h2><p>Dictionaries in Julia are very similar to dictionaries in other scripting languages, and most details can be found in the official documentation <a href="https://docs.julialang.org/en/v1/base/collections/#Dictionaries">here</a>. The basic idea is the same as in Python, for example: a dictionary is a collection of items that are accessed by <em>keys</em>. In general, almost anything that can be assigned as a variable in Julia is a valid item, and every hash-able object can act as a key.</p><p>One would write in Python</p><pre><code class="language-python hljs"># Python example
d = {1: &quot;one&quot;, 2: &quot;two&quot;}</code></pre><p>and similarly in Julia</p><pre><code class="language-julia hljs"># Julia example
d = Dict(1 =&gt; &quot;one&quot;, 2 =&gt; &quot;two&quot;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Dict{Int64, String} with 2 entries:
  2 =&gt; &quot;two&quot;
  1 =&gt; &quot;one&quot;</code></pre><p>In both Python and Julia, the values can be accessed in various ways, such as directly typing the key:</p><pre><code class="language-python hljs"># Python
d[1]
# should result in output of &quot;one&quot;</code></pre><p>and here the Julia output:</p><pre><code class="language-julia hljs"># Julia
d[1]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">&quot;one&quot;</code></pre><p>There are differences between Python&#39;s and Julia&#39;s dictionaries however, and two of those are particularly important for RetrievalToolbox. First, many more of Julia&#39;s various objects are hash-able, and can therefore be used as keys in dictionaries. For example, we can create a dictionary whose keys are arrays:</p><pre><code class="language-julia hljs">d = Dict([1,2,3] =&gt; &quot;first three&quot;, [4,5] =&gt; &quot;four and five&quot;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Dict{Vector{Int64}, String} with 2 entries:
  [1, 2, 3] =&gt; &quot;first three&quot;
  [4, 5]    =&gt; &quot;four and five&quot;</code></pre><p>The example above is not possible in (pure) Python as lists or numpy arrays are not hash-able by default. The second important difference relates to the specific data type of dictionaries. In Julia, they are not simply &quot;dictionaries&quot;, but can be <em>specific</em> dictionary types that lay out the specific types of both keys and items. In the example above, the dictionary type is actually printed along with the contents: this dictionary <code>d</code> maps a vector of 64-bit integers (<code>Vector{Int64}</code>) to strings (<code>String</code>).</p><p>Once created, it is possible to add new items to the collection <strong>as long as they match the dictionary type</strong>. Thus, we can add another item:</p><pre><code class="language-julia hljs">d[[100]] = &quot;only one hundred&quot;
d</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Dict{Vector{Int64}, String} with 3 entries:
  [100]     =&gt; &quot;only one hundred&quot;
  [1, 2, 3] =&gt; &quot;first three&quot;
  [4, 5]    =&gt; &quot;four and five&quot;</code></pre><p>However, the following fails, since the key is not a list of 64-bit integers:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; d[101] = &quot;one hundred and one&quot;</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: MethodError: Cannot `convert` an object of type <span class="sgr92">Int64</span> to an object of type <span class="sgr91">Vector{Int64}</span>
The function `convert` exists, but no method is defined for this combination of argument types.

Closest candidates are:
  convert(::Type{Array{T, N}}, <span class="sgr91">::StaticArraysCore.SizedArray{S, T, N, N, Array{T, N}}</span>) where {S, T, N}
<span class="sgr90">   @</span> <span class="sgr36">StaticArrays</span> <span class="sgr90">~/.julia/packages/StaticArrays/IZgIP/src/<span class="sgr4">SizedArray.jl:88</span></span>
  convert(::Type{Array{T, N}}, <span class="sgr91">::StaticArraysCore.SizedArray{S, T, N, M, TData} where {M, TData&lt;:AbstractArray{T, M}}</span>) where {T, S, N}
<span class="sgr90">   @</span> <span class="sgr36">StaticArrays</span> <span class="sgr90">~/.julia/packages/StaticArrays/IZgIP/src/<span class="sgr4">SizedArray.jl:82</span></span>
  convert(::Type{Array{S, N}}, <span class="sgr91">::PooledArrays.PooledArray{T, R, N}</span>) where {S, T, R, N}
<span class="sgr90">   @</span> <span class="sgr32">PooledArrays</span> <span class="sgr90">~/.julia/packages/PooledArrays/Vy2X0/src/<span class="sgr4">PooledArrays.jl:499</span></span>
  ...</code></pre><p>Julia attempts by default to automatically convert <code>101</code> into a <code>Vector{Int64}</code> object, but no such conversion exists, and therefore the call above fails.</p><p>In order to allow for key/item pairs of different types to be stored in one dictionary, one must initialize the dictionary accordingly. The most general form is a dictionary of type <code>Dict{Any,Any}</code> which can map any key to any item:</p><pre><code class="language-julia hljs">d = Dict{Any,Any}()
d[&quot;something&quot;] = [1,2,3]
d[&#39;a&#39;] = 1:3
d[123.456] = Float32
d</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Dict{Any, Any} with 3 entries:
  123.456     =&gt; Float32
  &#39;a&#39;         =&gt; 1:3
  &quot;something&quot; =&gt; [1, 2, 3]</code></pre><p>As can be seen in the code above, we can add key/item pairs of <code>String</code>/<code>Vector{Int64}</code>, <code>Char</code>/<code>UnitRange{Int64}</code> and <code>Float64</code>/<code>DataType</code> into the dictionary, and it will be accepted since <code>d</code> can use <code>Any</code> for both keys and items.</p><p>Usage of <code>Any</code> in dictionaries can be convenient, however is generally discouraged in cases where performance matters. In RetrievalToolbox, as we will see below, dictionaries are used for bookkeeping mostly, and there is no performance-critical component directly attached to them. There are a few cases in RetrievalToolbox, where <code>Any</code> is used as either the key or item type.</p><h2 id="Usage-in-RetrievalToolbox"><a class="docs-heading-anchor" href="#Usage-in-RetrievalToolbox">Usage in RetrievalToolbox</a><a id="Usage-in-RetrievalToolbox-1"></a><a class="docs-heading-anchor-permalink" href="#Usage-in-RetrievalToolbox" title="Permalink"></a></h2><p>Dictionaries in RetrievalToolbox are used to perform bookkeeping in order to connect different objects together that are related without having some explicit dependency. A very instructive example are objects of type <code>EarthAtmosphereOpticalProperties</code>. Inside those objects we find fields such as <code>aerosol_tau</code> or <code>gas_tau</code>. Those fields are intended to contain the spectrally dependent per-layer optical depths due to aerosols or gases present in the model atmosphere. The optical depth information is stored as array to allow for high-performance computations.</p><p>Bookkeeping is crucial; we want to minimize possible assignment errors, meaning the confusion of which gas and which array belong together. Traditionally, the bookkeeping would be done via some form of index which would be carried throughout the program to (for example) signify that index <code>1</code> represents the oxygen gas, and index <code>2</code> is water vapor.</p><p>Dictionaries allow us to make this bookkeeping more intuitive and more elegantly. the <code>gas_tau</code> field, for example, is a dictionary of type <code>Dict{GasAbsorber{T}, Array{T, 2}}</code>. In this dictionary we directly map a <code>GasObserver</code> object to the matching array. There is no need to carry an additional bookkeeping token which links the correct gas absorber to the correct array.</p><p>Another example is how radiative transfer (RT) objects are managed inside the <code>EarthAtmosphereBuffer</code>. Since it is possible to arrange for several spectral windows to be part of a buffer, the RT methods are indexed in a dictionary of type <code>Dict{&lt;:AbstractSpectralWindow, &lt;:AbstractRTMethod}</code>. For some <code>EarthAtmosphereBuffer</code> <code>buf</code>, and a spectral window <code>swin</code>, we can write</p><pre><code class="language-julia hljs">rt = buf.rt[swin]</code></pre><p>which would return the <code>AbstractRTMethod</code> object that is logically linked to our spectral window. Note again here the distinction. The <code>AbstractRTMethod</code> object itself <strong>does not have an explicit dependence</strong> on the spectral window, even though its field <code>optical_properties</code> does. Hence, dictionaries like this are usually employed when the direct dependence is not established within object properties themselves, but needs to be tracked overall.</p><p>So internally, this type of referencing can reduce potential programming errors. There is also a benefit on the user side. If users want to inspect some underlying quantity, like the layer-resolved optical depths due to gas absorption, the also do not have to worry about some arbitrary index that links a gas to this quantity. One could just inquire via the gas objects themselves.</p><pre><code class="language-julia hljs"># let `swin` be the spectral window of interest, and `buf` be a buffer object
rt = buf.rt[swin] # Get the RT object from `swin`
gas_o2 = RE.get_gas_from_name(buf.scene.atmosphere, &quot;O2&quot;) # Get the gas object
# We can now obtain the optical depth array for the gas `gas_o2`
gas_tau_o2 = rt.optical_properties.gas_tau[gas_o2]</code></pre><p>In above code example, there was no need to use any arbitrary index to access the objects of interest, the objects themselves reference each other where appropriate: starting from some spectral window <code>swin</code>, we take the RT object <code>rt</code> via the dictionary <code>buf.rt</code>. Since we also have our gas observer <code>gas_o2</code>, we can directly obtain the gas optical depth array through the <code>rt.optical_properties</code> dictionary by use <code>gas_o2</code> as the <em>key</em>.</p><p>Note that adding allocated objects to an existing dictionary, or even creating a dictionary with already allocated objects, does not (in general) allocate new memory! Therefore, there is no additional memory footprint due to objects appearing in one or more dictionaries.</p><p>Look at the memory footprint below. The first call allocates a new array in memory and reserves several MiB of memory in the process. The second call only establishes the dictionary via referencing and does not need to allocate the existing array anew.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; @time a = rand(500, 5_000);</code><code class="nohighlight hljs ansi" style="display:block;">  0.005082 seconds (42 allocations: 19.076 MiB)</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; @time d = Dict(1 =&gt; a);</code><code class="nohighlight hljs ansi" style="display:block;">  0.000015 seconds (13 allocations: 912 bytes)</code></pre><div class="admonition is-success" id="Tip-84cfa356607b9d3a"><header class="admonition-header">Tip<a class="admonition-anchor" href="#Tip-84cfa356607b9d3a" title="Permalink"></a></header><div class="admonition-body"><p>Creating a dictionary in Julia with existing objects generally does not allocate new memory!</p></div></div></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../develop/">« Develop</a><a class="docs-footer-nextpage" href="../units/">Units »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Wednesday 7 January 2026 14:40">Wednesday 7 January 2026</span>. Using Julia version 1.12.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
